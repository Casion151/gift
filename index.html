<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Unlock-by-Quiz Link</title>
  <!-- Tailwind via Play CDN (dev-friendly) -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <!-- Marked (Markdown -> HTML) -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- DOMPurify (sanitize HTML) -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.7/dist/purify.min.js"></script>
  <style>
    /* Optional: focus rings for accessibility */
    :focus { outline: 2px solid; outline-offset: 2px; }
    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at 20% 20%, rgba(255, 230, 250, 0.65), transparent 55%),
                  radial-gradient(circle at 80% 30%, rgba(255, 215, 180, 0.6), transparent 60%),
                  linear-gradient(180deg, #1a0c24 0%, #351a3b 40%, #120414 100%);
      color: #fdf6ff;
      overflow-x: hidden;
    }
    main {
      position: relative;
      z-index: 1;
    }
    .butterfly-canvas {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      filter: blur(0.1px);
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(18px);
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 20px 45px rgba(21, 7, 30, 0.35);
    }
    .glass-card h2,
    .glass-card p,
    .glass-card span,
    .glass-card label,
    .glass-card legend,
    .glass-card li,
    .glass-card strong,
    .glass-card em,
    .glass-card code {
      color: #fdf6ff;
    }
    .glass-card input[type="text"],
    .glass-card input[type="radio"],
    .glass-card input[type="checkbox"] {
      background-color: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.3);
      color: #1a0027;
    }
    .glass-card input::placeholder {
      color: rgba(26, 0, 39, 0.55);
    }
    .glass-card button,
    .glass-card a {
      box-shadow: 0 10px 25px rgba(90, 29, 120, 0.35);
    }
    .glass-card a {
      color: #ffd4ff;
    }
    .glass-card .text-gray-500 { color: rgba(255, 245, 255, 0.75); }
    .glass-card .text-gray-600 { color: rgba(255, 245, 255, 0.85); }
    .glass-card .text-gray-800 { color: #fdf6ff; }
    .glass-card .text-gray-900 { color: #fdf6ff; }
    footer {
      color: rgba(255, 245, 255, 0.7);
    }
    .status-card {
      padding: 1rem 1.25rem;
      border-radius: 1rem;
      background: rgba(255, 255, 255, 0.12);
      border: 1px solid rgba(255, 255, 255, 0.22);
      backdrop-filter: blur(18px);
      box-shadow: 0 16px 40px rgba(35, 8, 60, 0.35);
      color: #fff8ff;
      font-size: 0.95rem;
      line-height: 1.6;
    }
    .status-success {
      border-color: rgba(160, 255, 224, 0.6);
      box-shadow: 0 18px 40px rgba(70, 255, 209, 0.2);
      background: linear-gradient(135deg, rgba(22, 170, 140, 0.28), rgba(18, 26, 48, 0.35));
    }
    .status-info {
      background: linear-gradient(135deg, rgba(125, 90, 200, 0.32), rgba(22, 14, 40, 0.4));
    }
    .status-warn {
      border-color: rgba(255, 200, 140, 0.55);
      background: linear-gradient(135deg, rgba(255, 180, 120, 0.32), rgba(44, 16, 20, 0.45));
      box-shadow: 0 18px 42px rgba(255, 158, 120, 0.28);
    }
    .gift-button {
      padding: 0.6rem 1.5rem;
      border-radius: 9999px;
      background: linear-gradient(135deg, rgba(255, 165, 210, 0.95), rgba(255, 105, 180, 0.95));
      color: #ffffff;
      font-weight: 600;
      letter-spacing: 0.03em;
      border: none;
      cursor: pointer;
      box-shadow: 0 15px 35px rgba(255, 120, 190, 0.38);
      transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
    }
    .gift-button:hover {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 18px 42px rgba(255, 130, 200, 0.45);
      filter: brightness(1.05);
    }
    .gift-button:active {
      transform: translateY(1px) scale(0.97);
    }
    .rose-overlay {
      position: fixed;
      inset: 0;
      z-index: 40;
      pointer-events: none;
      overflow: hidden;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    .rose-overlay.active {
      opacity: 1;
    }
    .rose-overlay .rose {
      position: absolute;
      top: 110%;
      left: var(--left, 50%);
      width: 82px;
      height: 82px;
      margin-left: -41px;
      background: radial-gradient(circle at 32% 28%, #ffe9f8 0%, #ffbfdc 38%, #ff8cc1 68%, #ff4b9d 100%);
      border-radius: 50%;
      filter: drop-shadow(0 12px 30px rgba(255, 120, 190, 0.4));
      opacity: 0;
      transform: translate3d(0, 0, 0) scale(var(--scale, 1));
      animation: roseFloat var(--duration, 10s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }
    .rose-overlay .rose::before,
    .rose-overlay .rose::after {
      content: '';
      position: absolute;
      inset: 15%;
      border-radius: 50%;
      background: radial-gradient(circle at 50% 40%, rgba(255, 255, 255, 0.55) 0%, rgba(255, 160, 210, 0.9) 45%, rgba(255, 95, 165, 0.95) 100%);
      transform: rotate(25deg);
      filter: blur(0.3px);
    }
    .rose-overlay .rose::after {
      inset: 28%;
      transform: rotate(-18deg);
      background: radial-gradient(circle at 40% 40%, rgba(255, 255, 255, 0.7) 0%, rgba(255, 170, 215, 0.95) 60%, rgba(255, 110, 178, 0.95) 100%);
    }
    .rose-overlay .petal {
      position: absolute;
      top: -10%;
      left: var(--left, 50%);
      width: 26px;
      height: 38px;
      margin-left: -13px;
      background: radial-gradient(circle at 30% 20%, #fff5fb 0%, #ffc7e0 45%, #ff96c4 100%);
      border-radius: 60% 40% 60% 40%;
      opacity: 0;
      transform: rotate(var(--rotate, 0deg)) scale(var(--scale, 1));
      filter: drop-shadow(0 8px 14px rgba(255, 150, 205, 0.32));
      animation: petalFall var(--duration, 8s) linear infinite;
      animation-delay: var(--delay, 0s);
    }
    @keyframes roseFloat {
      0% {
        transform: translate3d(0, 0, 0) scale(var(--scale, 1)) rotate(0deg);
        opacity: 0;
      }
      12% {
        opacity: 1;
      }
      55% {
        transform: translate3d(var(--drift, 45px), -55vh, 0) scale(var(--scale, 1)) rotate(18deg);
      }
      100% {
        transform: translate3d(calc(var(--drift, 45px) * 1.4), -120vh, 0) scale(var(--scale, 1)) rotate(42deg);
        opacity: 0;
      }
    }
    @keyframes petalFall {
      0% {
        transform: translate3d(0, -8vh, 0) rotate(var(--rotate, 0deg)) scale(var(--scale, 1));
        opacity: 0;
      }
      18% {
        opacity: 1;
      }
      65% {
        opacity: 1;
      }
      100% {
        transform: translate3d(var(--drift, 90px), 120vh, 0) rotate(calc(var(--rotate, 0deg) + 220deg)) scale(var(--scale, 1));
        opacity: 0;
      }
    }
  </style>
</head>
<body class="min-h-dvh antialiased">
  <canvas id="butterflyCanvas" class="butterfly-canvas"></canvas>
  <main class="mx-auto max-w-2xl px-4 py-10">
    <header class="mb-6 text-white">
      <h1 class="text-3xl font-bold tracking-tight drop-shadow-lg">ü•Æüåï Challenge designed by Autumn God</h1>
      <p class="mt-1 opacity-80">Answer a few magic questions to ü™Ñ the content.</p>
    </header>
    <!-- Progress / Status -->
    <div id="status" class="mb-6 hidden"></div>
    <!-- Quiz Card -->
    <section id="quizCard" class="glass-card rounded-2xl p-5 space-y-6">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-semibold">Verification</h2>
        <span id="progress" class="text-sm text-gray-500">0 / 0 correct</span>
      </div>
      <form id="quizForm" class="space-y-6"></form>
      <div class="flex items-center gap-3 pt-2">
        <button id="checkBtn" class="px-4 py-2 rounded-2xl bg-gray-900 text-white hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed" type="button">Check answers</button>
        <button id="resetBtn" class="px-3 py-2 rounded-2xl bg-gray-200 text-gray-800 hover:bg-gray-300" type="button">Reset</button>
      </div>
      <p class="text-xs text-gray-500">Note: Your pass is cached on this device for convenience. Use ‚ÄúReset‚Äù to clear it.</p>
    </section>
    <!-- Content Card (hidden until passed) -->
    <section id="contentCard" class="hidden mt-8 glass-card rounded-2xl overflow-hidden">
      <div class="flex items-center justify-between p-5 border-b">
        <h2 class="text-xl font-semibold">ÁªùÂØÜÔºÅÊ°£Ê°àËß£ÈîÅ‚Äî‚Äî‚Äî‚ÄîËØ∑‰∏ãËΩΩmdÊñá‰ª∂Ëé∑ÂèñÂπ∂Êü•ÁúãÔºåÂÖ∂ÁªèËøáÁ≤æÂøÉÊéíÂàóÔºåÊòìËØª</h2>
        <div class="flex gap-2">
          <button id="downloadMdBtn" class="px-3 py-1.5 rounded-xl bg-gray-900 text-white hover:bg-gray-800">Download .md</button>
          <a id="downloadUrlBtn" class="px-3 py-1.5 rounded-xl bg-gray-200 text-gray-800 hover:bg-gray-300 hidden" href="#" download>Download file</a>
        </div>
      </div>
      <article id="renderTarget" class="prose prose-gray px-5 py-6 max-w-none"></article>
      <div class="px-5 pb-6 pt-4 border-t border-white/10 flex justify-end">
        <button id="giftButton" class="gift-button hidden">‰∏çÊ≠£ÁªèÁöÑÁ§ºÁâ©</button>
      </div>
    </section>
    <footer class="mt-10 text-xs text-gray-500">
      <p>‰Ω†Â•Ω, oi!</p>
    </footer>
  </main>
  <div id="roseOverlay" class="rose-overlay hidden"></div>
  <script>
    (function () {
      const canvas = document.getElementById('butterflyCanvas');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      const butterflies = [];
      const sparkles = [];
      let width = 0;
      let height = 0;
      const MAX_BUTTERFLIES = 48;
      const MAX_SPARKLES = 90;
      function resize() {
        const dpr = window.devicePixelRatio || 1;
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width * dpr;
        canvas.height = height * dpr;
        canvas.style.width = `${width}px`;
        canvas.style.height = `${height}px`;
        ctx.setTransform(1, 0, 0, 1, 0, 0);
        ctx.scale(dpr, dpr);
      }
      function createButterfly(seedY) {
        return {
          x: Math.random() * width,
          y: seedY ?? (height + Math.random() * height),
          speed: 0.35 + Math.random() * 0.55,
          drift: 0.6 + Math.random() * 0.6,
          life: Math.random() * Math.PI * 2,
          wingFrequency: 2.2 + Math.random() * 1.6,
          rotation: (Math.random() - 0.5) * 0.9,
          scale: 0.35 + Math.random() * 0.55,
          tint: Math.random()
        };
      }
      function createSparkle(seedY) {
        return {
          x: Math.random() * width,
          y: seedY ?? (Math.random() * height),
          radius: 0.4 + Math.random() * 1.8,
          speed: 0.08 + Math.random() * 0.18,
          twinkle: Math.random() * Math.PI * 2,
          hueShift: Math.random()
        };
      }
      function initPopulation() {
        butterflies.length = 0;
        sparkles.length = 0;
        for (let i = 0; i < MAX_BUTTERFLIES; i++) {
          butterflies.push(createButterfly(Math.random() * height));
        }
        for (let i = 0; i < MAX_SPARKLES; i++) {
          sparkles.push(createSparkle(Math.random() * height));
        }
      }
      function drawButterfly(b) {
        const flutter = Math.sin(b.life * b.wingFrequency);
        const flutterScale = b.scale * (1 + flutter * 0.25);
        ctx.save();
        ctx.translate(b.x, b.y);
        ctx.rotate(b.rotation + flutter * 0.12);
        const baseRadius = 28 * flutterScale;
        const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, baseRadius);
        if (b.tint < 0.5) {
          gradient.addColorStop(0, 'rgba(255, 245, 225, 0.95)');
          gradient.addColorStop(0.45, 'rgba(255, 210, 140, 0.85)');
          gradient.addColorStop(1, 'rgba(255, 160, 110, 0.15)');
        } else {
          gradient.addColorStop(0, 'rgba(255, 245, 240, 0.95)');
          gradient.addColorStop(0.45, 'rgba(255, 160, 210, 0.8)');
          gradient.addColorStop(1, 'rgba(180, 90, 200, 0.18)');
        }
        ctx.globalAlpha = 0.92;
        for (const dir of [-1, 1]) {
          ctx.save();
          ctx.scale(dir, 1);
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.bezierCurveTo(-22 * flutterScale, -18 * flutterScale, -46 * flutterScale, -4 * flutterScale, -18 * flutterScale, 20 * flutterScale);
          ctx.bezierCurveTo(-8 * flutterScale, 26 * flutterScale, -2 * flutterScale, 12 * flutterScale, 0, 0);
          ctx.closePath();
          ctx.fillStyle = gradient;
          ctx.fill();
          ctx.restore();
        }
        ctx.globalAlpha = 0.95;
        ctx.fillStyle = 'rgba(45, 8, 70, 0.9)';
        ctx.beginPath();
        ctx.ellipse(0, 0, 2.3 * flutterScale, 16 * flutterScale, 0, 0, Math.PI * 2);
        ctx.fill();
        ctx.globalAlpha = 0.55;
        ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
        ctx.beginPath();
        ctx.ellipse(0, -6 * flutterScale, 1.5 * flutterScale, 3.6 * flutterScale, 0, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
        ctx.globalAlpha = 1;
      }
      function drawSparkle(s) {
        const twinkle = 0.25 + 0.35 * (1 + Math.sin(s.twinkle)) * 0.5;
        const alpha = 0.15 + twinkle * 0.55;
        ctx.beginPath();
        ctx.fillStyle = `rgba(255, ${190 + s.hueShift * 40 | 0}, ${200 + s.hueShift * 55 | 0}, ${alpha})`;
        ctx.arc(s.x, s.y, s.radius * (1 + twinkle * 0.8), 0, Math.PI * 2);
        ctx.fill();
      }
      let lastTime = 0;
      function animate(time) {
        const dt = Math.min((time - lastTime) / 1000 || 0, 0.032);
        lastTime = time;
        ctx.clearRect(0, 0, width, height);
        for (const s of sparkles) {
          s.y -= s.speed;
          s.twinkle += dt * 4;
          if (s.y < -10) {
            s.x = Math.random() * width;
            s.y = height + Math.random() * 30;
          }
          drawSparkle(s);
        }
        for (const b of butterflies) {
          b.life += dt;
          b.y -= b.speed;
          b.x += Math.sin(b.life * b.drift) * 0.6;
          if (b.y < -60 || b.x < -80 || b.x > width + 80) {
            Object.assign(b, createButterfly(height + Math.random() * 120));
          }
          drawButterfly(b);
        }
        requestAnimationFrame(animate);
      }
      resize();
      initPopulation();
      requestAnimationFrame((time) => {
        lastTime = time;
        animate(time);
      });
      window.addEventListener('resize', () => {
        resize();
        initPopulation();
      });
    })();
  </script>
  <script>
    // ======== CONFIGURE HERE ========
    // 1) Put your Markdown content here. You can replace this string or fetch it dynamically.
    const MARKDOWN = `üßö‚Äç‚ôÄÔ∏èdxqü¶ãÁâπÂÖ∏üéÄ\n# ÂõΩÂÜÖÁØá\n## 1. Á∫ø‰∏ã\n### 1.1 ËøëË∑ùÁ¶ªÁ∫ø‰∏ã‚Äî‚ÄîÂë®Êú´ÂíåÂπ≥Êó∂ÂèØ‰ª•ÂéªÂÆûÈ™åÂÆ§\n1. Âú®Ëá™Â∑±ÊâÄÂ§ÑÁöÑÂ≠¶Ê†°ÂØªÊâæËÄÅÂ∏àÔºàÊúÄÂØªÂ∏∏‰πüÊúÄÂÆπÊòìËøõÂÖ•ËØæÈ¢òÁªÑÔºâ\n    1. Â≠¶Ê†°ÂÜÖ\n    2. ÂíåÂ≠¶Ê†°ÊúâÂêà‰ΩúÂÖ≥Á≥ªÁöÑÁßëÁ†îÈô¢ÊâÄ‰∏éÊú∫ÊûÑÁöÑËØæÈ¢òÁªÑ\n2. Âú®ÊâÄÂ§ÑÂ≠¶Ê†°ÊâÄÂú®ÁöÑIPÂú∞ÁöÑÂÖ∂‰ªñÂ≠¶Ê†°ÂØªÊâæËØæÈ¢òÁªÑÔºàÂõ†‰∏∫Á¶ªÂæóËøëÔºåËÄå‰∏îÂèØ‰ª•Âë®Êú´ÂÖ®ÂäõÁ∫ø‰∏ãÊäïÂÖ•ÁßëÁ†îÂÆû‰π†Ôºâ\n    1. Ëá™Â∑±ÈÇÆ‰ª∂ËÅîÁ≥ªÔºåÊúÄÂ•ΩÊúâ‰∏ÄÂÆöÁöÑÁõ∏ÂÖ≥ËÉåÊôØÔºåÊØîÂ¶ÇËá™Â≠¶ËøáÁΩë‰∏ä‰∏Ä‰∫õÁü•ÂêçÂ§ßÂ≠¶ÁöÑÂÖ¨ÂºÄËØæÔºåÊúâËØæÁ®ãÈ°πÁõÆÔºåÊàñËÄÖ‰πãÂâçÂä†ÂÖ•ËøáÁõ∏ÂÖ≥ËØæÈ¢òÁªÑ‰ª•ÂèäÂèÇÂä†ËøáÁõ∏ÂÖ≥ËØæÈ¢òÊñπÂêëÊØîËæÉÂåπÈÖçÁöÑÁü•ÂêçÁ´ûËµõ\n    2. ÈÄöËøáÊú¨Ê†°ËÄÅÂ∏àÂ∏ÆÂøôÔºåËÆ§Áúü‰∏äÊú¨Ê†°ËÄÅÂ∏àÁöÑ‰∏ì‰∏öËØæÔºåÁßØÊûÅ‰∏éÂØπÊñπ‰∫§ÊµÅÔºàÂõ†‰∏∫ËÄÅÂ∏àÂè™ÊúâÁÜüÊÇâ‰Ω†Êâç‰ºöÂ∏Æ‰Ω†Ôºå‰∏çÁÑ∂Â∞±ÊòØÊØÅÂùèËá™Â∑±ÁöÑÂ≠¶ÊúØÂ£∞Ë™âÔºâ„ÄÇÊàñËÄÖÂÖàËøõÊú¨Ê†°ËÄÅÂ∏àËØæÈ¢òÁªÑËøõË°åÂÆû‰π†Â∏ÆÂøô„ÄÇËØ¢ÈóÆÊòØÂê¶ÊúâÁõ∏ÂÖ≥‰∫∫ËÑâÂ∏ÆÂøôÊé®Ëçê„ÄÇ\n    3. ÂèÇÂä†Â≠¶ÊúØ‰ºöËÆÆÔºåÂú®Èó¥ÈöôÁßØÊûÅ‰∏éËÄÅÂ∏à‰∫§ÊµÅÔºà‰∏çËøá‰∏ÄËà¨ËÄÅÂ∏àÊØîËæÉÂøôÔºåÈöæÊâæÂà∞Êú∫‰ºöÔºâÔºå‰ºöÂêéÂèäÊó∂ÂèëÈÇÆ‰ª∂ÁªôËÄÅÂ∏à‰ªãÁªçËá™Â∑±ÔºåË°®ÊòéËá™Â∑±ÂØπÂØπÊñπÊâÄËÆ≤Á†îÁ©∂ÁöÑÂÖ¥Ë∂£„ÄÇ\n### 1.2 ËøúË∑ùÁ¶ªÁ∫ø‰∏ã‚Äî‚ÄîÊöëÂÅáÁßëÁ†îÂÆû‰π†\n1. Áî≥ËØ∑ÂêÑÁßëÁ†îÈô¢ÊâÄÁöÑÂÆòÊñπÊöëÁ†îÈ°πÁõÆ(ÂåóÂ§ßÔºåÊ∏ÖÂçéÔºå‰∏≠ÁßëÂ§ßÔºåË•øÊπñÂ§ßÂ≠¶Ôºå‰∏≠ÁßëÈô¢ÔºåÂåóÁîüÊâÄÁ≠âÁ≠âÈÉΩÊúâÁõ∏ÂÖ≥ÁöÑÈ°πÁõÆ)\n    1. Â¶ÇÊûúÁî≥ËØ∑‰∏ç‰∏äÔºå‰πüÂèØ‰ª•Áî≥ËØ∑ÂØπÂ∫îÁöÑÊöëÊúüËØæÁ®ãÈ°πÁõÆÔºåÂú®ËØæÁ®ãÊúüÈó¥ÂéªÁõ∏ÂÖ≥ËØæÈ¢òÁªÑËßÅËØÜ‰∏Ä‰∏ã„ÄÇ\n2. Ëá™Ë°åËÅîÁ≥ªÔºàÊ≥®ÊÑèËØ¢ÈóÆÊòØËá™Â∑±Ë¥üË¥£ÁîüÊ¥ªË¥πËøòÊòØÂØπÊñπË°•Ë¥¥ÔºåÂêåÊó∂ËØ¢ÈóÆÊòØÂê¶‰ºöÊèê‰æõÊ≠£ÂºèÁöÑËÆøÈóÆÂ≠¶ÁîüIDÂç°Ôºâ\n    1. Ëá™Â∑±ÈÇÆ‰ª∂ËÅîÁ≥ªÔºåÊúÄÂ•ΩÊúâ‰∏ÄÂÆöÁöÑÁõ∏ÂÖ≥ËÉåÊôØÔºåÊØîÂ¶ÇËá™Â≠¶ËøáÁΩë‰∏ä‰∏Ä‰∫õÁü•ÂêçÂ§ßÂ≠¶ÁöÑÂÖ¨ÂºÄËØæÔºåÊúâËØæÁ®ãÈ°πÁõÆÔºåÊàñËÄÖ‰πãÂâçÂä†ÂÖ•ËøáÁõ∏ÂÖ≥ËØæÈ¢òÁªÑ‰ª•ÂèäÂèÇÂä†ËøáÁõ∏ÂÖ≥ËØæÈ¢òÊñπÂêëÊØîËæÉÂåπÈÖçÁöÑÁü•ÂêçÁ´ûËµõ\n    2. ÈÄöËøáÊú¨Ê†°ËÄÅÂ∏àÂ∏ÆÂøôÔºåËÆ§Áúü‰∏äÊú¨Ê†°ËÄÅÂ∏àÁöÑ‰∏ì‰∏öËØæÔºåÁßØÊûÅ‰∏éÂØπÊñπ‰∫§ÊµÅÔºàÂõ†‰∏∫ËÄÅÂ∏àÂè™ÊúâÁÜüÊÇâ‰Ω†Êâç‰ºöÂ∏Æ‰Ω†Ôºå‰∏çÁÑ∂Â∞±ÊòØÊØÅÂùèËá™Â∑±ÁöÑÂ≠¶ÊúØÂ£∞Ë™âÔºâ„ÄÇÊàñËÄÖÂÖàËøõÊú¨Ê†°ËÄÅÂ∏àËØæÈ¢òÁªÑËøõË°åÂÆû‰π†Â∏ÆÂøô„ÄÇËØ¢ÈóÆÊòØÂê¶ÊúâÁõ∏ÂÖ≥‰∫∫ËÑâÂ∏ÆÂøôÊé®Ëçê„ÄÇ\n    3. ÂèÇÂä†Â≠¶ÊúØ‰ºöËÆÆÔºåÂú®Èó¥ÈöôÁßØÊûÅ‰∏éËÄÅÂ∏à‰∫§ÊµÅÔºà‰∏çËøá‰∏ÄËà¨ËÄÅÂ∏àÊØîËæÉÂøôÔºåÈöæÊâæÂà∞Êú∫‰ºöÔºâÔºå‰ºöÂêéÂèäÊó∂ÂèëÈÇÆ‰ª∂ÁªôËÄÅÂ∏à‰ªãÁªçËá™Â∑±ÔºåË°®ÊòéËá™Â∑±ÂØπÂØπÊñπÊâÄËÆ≤Á†îÁ©∂ÁöÑÂÖ¥Ë∂£„ÄÇ\n## 2. Á∫ø‰∏ä(Â∞Ü‰∏éÂõΩÈôÖÁØáÊîæÂú®‰∏ÄËµ∑ËÆ®ËÆ∫)\n\n\n# ÂõΩÈôÖÁØá\n## 1. Á∫ø‰∏ãÔºà‰∏ÄËà¨‰∏çÂ≠òÂú®ËøúË∑ùÁ¶ªÁ∫ø‰∏ãÔºåÂõ†‰∏∫‰∏çÁ¨¶ÂêàÁ≠æËØÅËßÑÂÆöÔºå‰∏ÄËà¨Âè™ËÉΩÂú®Êèê‰æõÁ≠æËØÅÊîØÊåÅÁöÑÂ≠¶Ê†°ËøõË°åÁ∫ø‰∏ãÂÆû‰π†Ôºâ\n### 1.1 Êó•Â∏∏ÁâàÁ∫ø‰∏ã‚Äî‚ÄîÂë®Êú´ÂíåÂπ≥Êó∂ÂèØ‰ª•ÂéªÂÆûÈ™åÂÆ§\n1. Êä•ÂêçËØ•Â≠¶Ê†°ÁöÑËÆøÈóÆ‰∫§ÊµÅÈ°πÁõÆ\n    1. ‰∏ÄËà¨Â¶ÇÊûúÊòØÊò•Â≠¶ÊúüÔºà1ÊúàÂºÄÂßãÔºâÁöÑËØùÔºåÈúÄË¶ÅÊèêÂâçÂà∞ÁßãÂ≠¶ÊúüÂàöÂºÄÂßãÔºà9-10ÊúàÔºâÂ∞±ÂÅö‰∫§ÊµÅÈ°πÁõÆÁöÑÊä•ÂêçÂáÜÂ§á„ÄÇ‰πüÂ∞±ÊòØÊèêÂâç‰∏Ä‰∏™Â≠¶Êúü„ÄÇ\n    2. ÂÖ∑‰ΩìÊùêÊñôË¶ÅÊ±ÇÊ†πÊçÆÂ≠¶Ê†°ÊúâÂèòÂåñ„ÄÇ\n    3. ÂèØ‰ª•Êü•ÁúãÂØπÊØî‰∏Ä‰∏ãËá™Â∑±Êä•Âêç‰∏éÈÄöËøáÊú¨ÁßëÈô¢Ê†°Â∏ÆÂä©Êä•ÂêçÁöÑ‰∏çÂêåË¶ÅÊ±ÇÔºåÊúâÊó∂ÂÄôËá™Â∑±Êä•ÂêçÊâÄÈúÄÁöÑË¶ÅÊ±Ç‰ºöÊØîÈÄöËøáÊú¨ÁßëÈô¢Ê†°Êä•ÂêçËøò‰Ωé„ÄÇËÄå‰∏î‰∏ÄËà¨ÊùêÊñô‰∫§ÈΩêÊä•Âêç‰∫ÜÂ∞±ÈÉΩ‰ºöË¢´ÂΩïÂèñÔºàÊØïÁ´üÂõΩÂ§ñÂ≠¶Ê†°ÈÄöËøáÂ≠¶Ë¥πÂàõÊî∂Ôºâ„ÄÇ\n    4. Êúâ‰∫õÈ°πÁõÆÊù•‰∏çÂèäËÄÉËã±ËØ≠ÊàêÁª©ÁöÑËØùÔºåÂèØ‰ª•Êèê‰∫§ÊâòÁ¶èÊàñËÄÖÂ§öÈÇªÂõΩ‰ª£Êõø„ÄÇ\n    5. BBSAÈ°πÁõÆÊî∂Ë¥πÊòØÊúÄ‰ΩéÁöÑÔºåÂíåÊú¨Âú∞‰∫∫‰∏Ä‰∏™Ê†áÂáÜÔºåÂÖ∂‰ΩôÂü∫Êú¨ÈÉΩË¶Å3‰∏áÁæéÂÖÉ‰∏ÄÂ≠¶ÊúüÔºåÁõ∏Â∫îÁöÑÂùèÂ§ÑÊòØÂú®ÂÖ¨Á´ãÂ≠¶Ê†°ËøõÂÆûÈ™åÂÆ§ÊúâÁÇπÈ∫ªÁÉ¶„ÄÇ‰∏çËøá‰∏™‰∫∫‰ΩìÈ™åÂÖ∂ÂÆû‰πü‰∏çÊòØÁâπÂà´È∫ªÁÉ¶Ôºå‰∏ªË¶ÅÂú®‰∫éÈúÄË¶ÅÁßØÊûÅÊâæÊÑüÂÖ¥Ë∂£ÁöÑÊïôÊéà‰∫§ÊµÅ„ÄÇÂêåÊó∂ÔºåÊàëÊúâÂêåÂ≠¶ÂéªÊù•Âìà‰Ωõ‰∫§Êç¢ÔºåÂ•π‰πüÊâæ‰∏çÂà∞ËÄÅÂ∏àÊÑøÊÑèÊé•ÂèóÂ•πÔºåÊúÄÂêéÊòØÈù†ÂõΩÂÜÖËÄÅÂ∏àÔºàÂéüÊù•ÊòØÂìà‰ΩõÁöÑÂçöÂ£´ÂêéÔºâÂ∏ÆÂøôÊé®ËçêÂÆûÈ™åÂÆ§ÊâçËøõÂéªÁöÑ„ÄÇ\n6. ‰πãÂâçÊèêÂà∞ÂáÜÂ§á‰∫§ÊµÅÈ°πÁõÆÁöÑÁî≥ËØ∑ÊùêÊñôÔºåÂêåÊó∂‰πüÂèØ‰ª•ÂºÄÂßãÁªôÊÉ≥ÂéªÁöÑÂ≠¶Ê†°ÁöÑËÄÅÂ∏àÂÜôÈÇÆ‰ª∂ËØ¢ÈóÆËÉΩÂê¶Âä†ÂÖ•ÂØπÊñπËØæÈ¢òÁªÑ‰∫Ü„ÄÇËøôÊ†∑‰Ω†ÂèØ‰ª•ÊèêÂâçÂíåÂØπÈù¢ÂÆûÈ™åÂÆ§ÂØπÊé•Ôºå‰∏ÄËøáÂéªÂ∞±ÂèØ‰ª•ËøõË°åÁ†îÁ©∂ÔºåËÄÅÂ∏à‰πü‰ºöÊõ¥ÊÑøÊÑèÊé•ÂèóÂÅöËØæÈ¢òÊó∂Èó¥ÈïøÁöÑÂ≠¶Áîü„ÄÇ\n    1. Ëá™Â∑±ÈÇÆ‰ª∂ËÅîÁ≥ªÔºåÊúÄÂ•ΩÊúâ‰∏ÄÂÆöÁöÑÁõ∏ÂÖ≥ËÉåÊôØÔºåÂÅöËøáÁõ∏ÂÖ≥ÁöÑËØæÈ¢òÈ°πÁõÆÔºåÊàñËÄÖÊéåÊè°Áõ∏ÂÖ≥ÁöÑËØæÈ¢òÁªÑÊâÄÈúÄÁöÑÊäÄËÉΩ„ÄÇ\n    2. ÈÄöËøáÊüê‰∏™Â∑≤ÁªèËÆ§ËØÜ‰Ω†ÁöÑËÄÅÂ∏àÂ∏ÆÂøôÔºåËÆ§Áúü‰∏äÊú¨Ê†°ËÄÅÂ∏àÁöÑ‰∏ì‰∏öËØæÔºåÊàñËÄÖÁßØÊûÅ‰∏éÂØπÊñπ‰∫§ÊµÅËøáÔºàÂõ†‰∏∫ËÄÅÂ∏àÂè™ÊúâÁÜüÊÇâ‰Ω†Êâç‰ºöÂ∏Æ‰Ω†Ôºå‰∏çÁÑ∂Â∞±ÊòØÊØÅÂùèËá™Â∑±ÁöÑÂ≠¶ÊúØÂ£∞Ë™âÔºâ„ÄÇÊàñËÄÖ‰πãÂâçËøõËøáÊüê‰∏™ËÄÅÂ∏àËØæÈ¢òÁªÑËøõË°åÂÆû‰π†Â∏ÆÂøô„ÄÇËØ¢ÈóÆÊòØÂê¶ÊúâÁõ∏ÂÖ≥‰∫∫ËÑâÂ∏ÆÂøôÊé®Ëçê„ÄÇ\n    3. Âú®Áî≥ËØ∑ÂâçÂèÇÂä†ËøáÂ≠¶ÊúØ‰ºöËÆÆÔºåÂú®Â≠¶ÊúØ‰ºöËÆÆ‰∏ä‰∏éËÄÅÂ∏à‰∫§ÊµÅËøáÔºà‰∏çËøá‰∏ÄËà¨ËÄÅÂ∏àÊØîËæÉÂøôÔºåÈöæÊâæÂà∞Êú∫‰ºöÔºâÔºå‰ºöÂêéÊúâËøáÂèäÊó∂ÂèëÈÇÆ‰ª∂ÁªôËÄÅÂ∏à‰ªãÁªçËá™Â∑±ÔºåË°®ÊòéËá™Â∑±ÂØπÂØπÊñπÊâÄËÆ≤Á†îÁ©∂ÁöÑÂÖ¥Ë∂£„ÄÇËøôÊó∂Ôºå‰Ω†ÂÜçÂèë‰∏™ÈÇÆ‰ª∂ÁªôËÄÅÂ∏àËØ¥Êàë‰ªéxxx‰ºöËÆÆ‰∏äÂíå‰Ω†ËÅäËøáÔºåÁé∞Âú®ÂèàÊù•Êâæ‰Ω†‰∫ÜÔºåËÄÅÂ∏à‰ºöÊå∫ÊÑøÊÑèÊé•Âèó‰Ω†ÁöÑ„ÄÇ\n    4. ÈÄâÊã©ÊÉ≥ÂéªÁöÑÂõΩÂ§ñËÄÅÂ∏à‰∏äÁöÑËØæÔºå‰∏ãËØæ‰ª•Âêé‰∏ªÂä®ËØ¢ÈóÆËÄÅÂ∏àËøõÁªÑÊÉÖÂÜµ\n7. Ê≥®ÊÑèÔºöËøõËØæÈ¢òÁªÑ‰πãÂâçÂèØËÉΩÊúâ‰ª•‰∏ãÂá†ÁßçÊÉÖÂÜµÔºö\n    1. ÊúâËÄÉÊü•‰∏éÈù¢ËØïÔºåÊØîÂ¶ÇÂÆåÊàêÈ°πÁõÆÂÅöÊ±áÊä•ÂÜçÂÜ≥ÂÆöÊòØÂê¶ÈïøÊúüÂêà‰Ωú\n    2. ËÄÅÂ∏àÁõ¥Êé•Â∞Ü‰Ω†ÁöÑ‰ø°ÊÅØÊé®ÈÄÅÁªôÂçöÂ£´ÂêéÔºå‰Ω†Ëá™Â∑±ÂíåÂçöÂ£´ÂêéÂïÜÈáèÈ°πÁõÆ\n    3. ‰Ω†Áõ¥Êé•ÂíåËÄÅÂ∏àÂØπÊé•È°πÁõÆÔºàÊûÅÂ∞ëÔºåÈúÄË¶ÅÁèçÊÉúÔºâ\n### 1.2 ËøëË∑ùÁ¶ªÁ∫ø‰∏ã‚Äî‚Äî‰∏ÄÁõ¥ÂæÖÂú®ÂÆûÈ™åÂÆ§ÔºàÁ±ª‰ººÂçöÂ£´ÁîüÁöÑÁîüÊ¥ªÔºå‰∏çËøáÂèØËÉΩÊõ¥Ëã¶üòÜÂõ†‰∏∫ÂçöÂ£´ÁîüËá≥Â∞ëËøòÂèØ‰ª•ÂéªÂ≠¶Ê†°‰∏äËØæÊë∏È±ºÔºâ\n1. Êä•ÂêçËØ•Â≠¶Ê†°ÁöÑÂÆòÊñπÊöëÁ†îÈ°πÁõÆÔºàÊó∂Èó¥2‰∏™ÊúàÔºâÊàñËÄÖ‰∏éËØ•Â≠¶Ê†°ÁöÑËÄÅÂ∏àËá™Ë°åËÅîÁ≥ªÊöëÁ†îÔºàÊó∂Èó¥‰∏∫2‰∏™ÊúàÔΩû12‰∏™ÊúàÈÉΩÊúâÂèØËÉΩÂçèÂïÜÔºâÊó†ËÆ∫ÊòØÂì™ÁßçÔºåÈÉΩÈúÄË¶ÅÊèêÂâç3-6‰∏™ÊúàÂíåËÄÅÂ∏àËÅîÁ≥ª„ÄÇÂõ†‰∏∫ÈúÄË¶ÅÂäûÁ≠æËØÅÔºåÂæàÈ∫ªÁÉ¶ÔºÅ\n    1. Ëá™Â∑±ÈÇÆ‰ª∂ËÅîÁ≥ªÔºåÊúÄÂ•ΩÊúâ‰∏ÄÂÆöÁöÑÁõ∏ÂÖ≥ËÉåÊôØÔºåÂÅöËøáÁõ∏ÂÖ≥ÁöÑËØæÈ¢òÈ°πÁõÆÔºåÊàñËÄÖÊéåÊè°Áõ∏ÂÖ≥ÁöÑËØæÈ¢òÁªÑÊâÄÈúÄÁöÑÊäÄËÉΩ„ÄÇ\n    2. ÈÄöËøáÊüê‰∏™Â∑≤ÁªèËÆ§ËØÜ‰Ω†ÁöÑËÄÅÂ∏àÂ∏ÆÂøôÔºåËÆ§Áúü‰∏äÊú¨Ê†°ËÄÅÂ∏àÁöÑ‰∏ì‰∏öËØæÔºåÊàñËÄÖÁßØÊûÅ‰∏éÂØπÊñπ‰∫§ÊµÅËøáÔºàÂõ†‰∏∫ËÄÅÂ∏àÂè™ÊúâÁÜüÊÇâ‰Ω†Êâç‰ºöÂ∏Æ‰Ω†Ôºå‰∏çÁÑ∂Â∞±ÊòØÊØÅÂùèËá™Â∑±ÁöÑÂ≠¶ÊúØÂ£∞Ë™âÔºâ„ÄÇÊàñËÄÖ‰πãÂâçËøõËøáÊüê‰∏™ËÄÅÂ∏àËØæÈ¢òÁªÑËøõË°åÂÆû‰π†Â∏ÆÂøô„ÄÇËØ¢ÈóÆÊòØÂê¶ÊúâÁõ∏ÂÖ≥‰∫∫ËÑâÂ∏ÆÂøôÊé®Ëçê„ÄÇ\n    3. Âú®Áî≥ËØ∑ÂâçÂèÇÂä†ËøáÂ≠¶ÊúØ‰ºöËÆÆÔºåÂú®Á∫ø‰∏ãÊàñËÄÖÁ∫ø‰∏äÂ≠¶ÊúØ‰ºöËÆÆ‰∏ä‰∏éËÄÅÂ∏à‰∫§ÊµÅËøáÔºà‰∏çËøá‰∏ÄËà¨ËÄÅÂ∏àÊØîËæÉÂøôÔºåÈöæÊâæÂà∞Êú∫‰ºöÔºâÔºå‰ºöÂêéÊúâËøáÂèäÊó∂ÂèëÈÇÆ‰ª∂ÁªôËÄÅÂ∏à‰ªãÁªçËá™Â∑±ÔºåË°®ÊòéËá™Â∑±ÂØπÂØπÊñπÊâÄËÆ≤Á†îÁ©∂ÁöÑÂÖ¥Ë∂£„ÄÇËøôÊó∂Ôºå‰Ω†ÂÜçÂèë‰∏™ÈÇÆ‰ª∂ÁªôËÄÅÂ∏àËØ¥Êàë‰ªéxxx‰ºöËÆÆ‰∏äÂíå‰Ω†ËÅäËøáÔºåÁé∞Âú®ÂèàÊù•Êâæ‰Ω†‰∫ÜÔºåËÄÅÂ∏à‰ºöÊå∫ÊÑøÊÑèÊé•Âèó‰Ω†ÁöÑ„ÄÇ\n2. È¶ôÊ∏ØÁöÑÂ≠¶Ê†°ÁöÑÊöëÁ†îÈ°πÁõÆÁõ¥Êé•‰∏éÂçöÂ£´ÂΩïÂèñÊåÇÈí©„ÄÇ\n\n## 2. Á∫ø‰∏äÔºàÈ∫ªÁÉ¶ÁöÑÂú®‰∫éÁõÆÂâçÂØπ‰∫éÊï∞ÊçÆÁÆ°ÊéßÊØîËæÉ‰∏•Ê†ºÔºâ\n### 2.1 Êó•Â∏∏ÁâàÁ∫ø‰∏ä\n1. ÂÖàÊä•Âêç‰ªªÊÑèÂ≠¶Ê†°ÁöÑ‰∫§ÊµÅÈ°πÁõÆÔºåÂÜçËÅîÁ≥ªÂÖ∂‰ªñÂ≠¶Ê†°ÁöÑËÄÅÂ∏àËØ¢ÈóÆÊòØÂê¶ËÉΩËøõË°åÁ∫ø‰∏äÁßëÁ†îÈ°πÁõÆ„ÄÇÊñπÊ≥ïÂêå‰∏ä„ÄÇ\n### 2.2 ËÇâË∫´Âú®ÂõΩÂÜÖÁöÑÁ∫ø‰∏ä\n1. ÂèØ‰ª•ÈÄöËøáÊü•ÈòÖÂêÑÂ≠¶Ê†°ÁΩëÁ´ôÊúâÊó†ÂºÄÊîæÁöÑÁ∫ø‰∏äÈ°πÁõÆÔºåÊØîÂ¶ÇÊàë‰ª•ÂâçÂ∞±Êü•Âà∞StanfordÊòØÊúâ‰∏Ä‰∏™Ë°®Ê†º‰∏ìÈó®ÂÅöËøô‰∏™‰∫ãÊÉÖÁöÑ„ÄÇhttps://docs.google.com/spreadsheets/d/1yDtCqr36_tMc85M6Usfg877KMoM6lde-E-i6PeW1Ziw/edit?gid=923159611#gid=923159611\n2. Ëá™Ë°åËÅîÁ≥ª ÊñπÊ≥ïÂêå‰∏ä„ÄÇÊúâ‰∫õËÄÅÂ∏àÁöÑÂÆûÈ™åÂÆ§ÂÆòÁΩë‰∏ä‰πü‰ºöÊúâÂÜôÊãõÂãüËøúÁ®ãÁßëÁ†î„ÄÇ‰∏æ‰∏™üå∞Ôºöhttps://bioinformatics.bwh.harvard.edu/join/\n`;
    // 2) Optional: expose a real download URL after pass (e.g., from Drive/S3).
    // Leave empty string to hide the button.
    const DOWNLOAD_URL_AFTER_PASS = ""; // e.g., "https://example.com/yourfile.pdf"
    // 3) Define your questions. Answers are *hashed* with SHA-256 to avoid plain-text answers in source.
    //    Use window.hashPlain('your answer') in DevTools to generate hashes with the same normalization as checks.
    //    Types: 'text' | 'single' (radio) | 'multiple' (checkbox)
    const QUESTIONS = [
      {
        id: 'q1',
        type: 'text',
        prompt: 'Who is Magic_QiQi?',
        placeholder: 'ËØ∑ÂáÜÁ°ÆÊó†ËØØÂú∞ËæìÂÖ•‰Ω†ÁöÑÂêçÂ≠ó',
        answerHash: '8089263d065ce1db56e3d53f90e56fd556bc8cdb81a7f6606045b9995204393b', // hash of "Êà¥Á≠±Áê™"
        hint: '‰Ω†ÁöÑÂêçÂ≠ó'
      },
      {
        id: 'q2',
        type: 'multiple',
        prompt: '‰∏∫‰ªÄ‰πàÈÄâÊã©Âú®‰ªäÂ§©ÂèëÁªô‰Ω†',
        choices: [
          { id: 'a', label: 'Ê≠£Â•ΩÊòØËÆ§ËØÜÁöÑÊª°Âõõ‰∏™Êúà' },
          { id: 'b', label: 'Ê≠£Â∑ß‰ªäÂ§©ÂºÑÂ•ΩÁÅµÊú∫‰∏ÄÂä®' },
          { id: 'c', label: 'Ê≠£ÈÄ¢‰Ω≥ËäÇ‰∏éÂΩ©ÊéíÁöÑÂâçÂ§ï' },
          { id: 'd', label: 'ÂÖ∂‰ªñÔºåËØ∑Â°´ÂÜô‰Ω†ÁöÑÁêÜÁî±', allowCustom: true, customPlaceholder: 'ÂÜô‰∏ã‰Ω†ÁöÑÁêÜÁî±Âêß' }
        ],
        correctOptionsHashes: [
          '3e23e8160039594a33894f6564e1b1348bbd7a0088d42c4acb73eeaed59c009d', // 'b'
          '18ac3e7343f016890c510e93f935261169d9e3f565436429830faf0934f4f8e4', // 'd'
          '3f7dc29ee8aedb343414c6fe5d5cf9dd5fdee5b6e25ffd3afc54ff9e026712fb'  // 'b|d'
        ]
      },
      {
        id: 'q3',
        type: 'multiple',
        prompt: '‰Ω†‰ªäÂ§©Âø´‰πêüéä‰∫ÜÂêó',
        choices: [
          { id: 'a', label: '‰∏çÂø´‰πêÔºåÂΩ©ÊéíÂ•ΩÁ¥Ø' },
          { id: 'b', label: '‰∏çÂø´‰πêÔºåÊµÅ‰∫ÜÂ•ΩÂ§öÊ±ó' },
          { id: 'c', label: '‰∏çÂø´‰πêÔºåÂ§©Ê∞î‰∏çÂ•Ω' },
          { id: 'd', label: '‰∏çÂø´‰πêÔºåÈ¢Ü‰∏™Êñá‰ª∂Êï¥Ëøô‰πàËä±Âì®' },
          { id: 'e', label: 'ÂÖ∂‰ªñÔºåËØ∑Â°´ÂÜô‰Ω†ÁöÑÊÑüÂèó', allowCustom: true, customPlaceholder: 'ÂÜô‰∏ã‰Ω†ÁöÑÊÑüÂèóÂêß' },
        ],
        acceptAnySelection: true
      }
    ];
    // 4) Optional: gate by token in URL (e.g., you share /?token=abc123 to one person). If provided,
    //    we store it and require the same token to see the cached pass. Set to false to disable token gating.
    const REQUIRE_URL_TOKEN_TO_REUSE_PASS = true;
    // 5) Optional: push completed responses to a GitHub repo. Fill in these values (token requires repo write access).
    const GITHUB_UPLOAD_CONFIG = {
      owner: 'Casion151',
      repo: 'gift',
      mode: 'issue', // 'issue' to open GitHub issues, 'file' to append to a JSON file
      path: 'quiz-responses.json', // used only when mode === 'file'
      branch: 'main',
      commitMessage: 'Add quiz response',
      issueTitle: 'Quiz response from gate',
      issueLabels: ['quiz-response'],
      token: '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' // personal access token; hard-coded for automatic uploads
    };
    // ======== END CONFIG ========
    // Allow setting GitHub token at runtime for safer local testing
    try {
      const storedToken = localStorage.getItem('quiz-gh-token');
      if (storedToken && !GITHUB_UPLOAD_CONFIG.token) {
        GITHUB_UPLOAD_CONFIG.token = storedToken;
      }
    } catch (error) {
      console.warn('Unable to read stored GitHub token:', error);
    }
    window.setQuizGithubToken = (token) => {
      GITHUB_UPLOAD_CONFIG.token = token || '';
      try {
        if (token) localStorage.setItem('quiz-gh-token', token);
        else localStorage.removeItem('quiz-gh-token');
      } catch (error) {
        console.warn('Unable to persist GitHub token:', error);
      }
      return !!token;
    };
    const el = {
      quizCard: document.getElementById('quizCard'),
      contentCard: document.getElementById('contentCard'),
      quizForm: document.getElementById('quizForm'),
      checkBtn: document.getElementById('checkBtn'),
      resetBtn: document.getElementById('resetBtn'),
      progress: document.getElementById('progress'),
      renderTarget: document.getElementById('renderTarget'),
      status: document.getElementById('status'),
      downloadMdBtn: document.getElementById('downloadMdBtn'),
      downloadUrlBtn: document.getElementById('downloadUrlBtn'),
      giftBtn: document.getElementById('giftButton'),
      giftOverlay: document.getElementById('roseOverlay'),
    };
    let giftDismissHandler = null;
    // Utilities
    const norm = (str) => str.trim().toLowerCase().replace(/\s+/g, ' ');
    const toHex = (buffer) => Array.from(new Uint8Array(buffer)).map(b => b.toString(16).padStart(2, '0')).join('');
    async function sha256Hex(input) {
      const data = new TextEncoder().encode(norm(input));
      const hash = await crypto.subtle.digest('SHA-256', data);
      return toHex(hash);
    }
    // Dev helper: quickly generate an answer hash in console.
    window.hashPlain = async (s) => {
      const h = await sha256Hex(String(s));
      console.log(`SHA-256(${JSON.stringify(norm(String(s)))}) =`, h);
      return h;
    };
    // Token handling (optional)
    const url = new URL(location.href);
    const urlToken = url.searchParams.get('token') || '';
    // Local cache key
    const CACHE_KEY = 'quiz-gate-pass-v1';
    function readCache() {
      try {
        return JSON.parse(localStorage.getItem(CACHE_KEY) || '{}');
      } catch { return {}; }
    }
    function writeCache(obj) {
      localStorage.setItem(CACHE_KEY, JSON.stringify(obj));
    }
    function clearCache() {
      localStorage.removeItem(CACHE_KEY);
    }
    // Attempt counters per question
    const attempts = new Map();
    // Render quiz
    function renderQuiz() {
      el.quizForm.innerHTML = '';
      let correctCount = 0;
      attempts.clear();
      QUESTIONS.forEach((q, idx) => {
        const field = document.createElement('fieldset');
        field.className = 'space-y-2';
        field.dataset.qid = q.id;
        const label = document.createElement('legend');
        label.className = 'font-medium flex items-center gap-2';
        label.innerHTML = `<span class="text-gray-800">${idx + 1}. ${q.prompt}</span>`;
        field.appendChild(label);
        const help = document.createElement('div');
        help.className = 'text-sm text-gray-500 hidden';
        help.id = `hint-${q.id}`;
        if (q.hint) help.textContent = q.hint;
        field.appendChild(help);
        const inputWrap = document.createElement('div');
        inputWrap.className = 'mt-1';
        if (q.type === 'text') {
          const input = document.createElement('input');
          input.type = 'text';
          input.placeholder = q.placeholder || '';
          input.className = 'w-full rounded-xl border px-3 py-2';
          input.name = q.id;
          inputWrap.appendChild(input);
        }
        else if (q.type === 'single') {
          q.choices.forEach(choice => {
            const id = `${q.id}-${choice.id}`;
            const row = document.createElement('div');
            row.className = 'space-y-2';
            const optionLabel = document.createElement('label');
            optionLabel.className = 'flex items-center gap-3 rounded-xl border px-3 py-2 hover:bg-gray-50';
            optionLabel.setAttribute('for', id);
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.name = q.id;
            radio.id = id;
            radio.value = choice.id;
            radio.className = 'size-4';
            const text = document.createElement('span');
            text.textContent = choice.label;
            optionLabel.appendChild(radio);
            optionLabel.appendChild(text);
            row.appendChild(optionLabel);
            if (choice.allowCustom) {
              const customInput = document.createElement('input');
              customInput.type = 'text';
              customInput.placeholder = choice.customPlaceholder || 'ËØ∑ËæìÂÖ•‰Ω†ÁöÑÁ≠îÊ°à';
              customInput.className = 'ml-7 mt-1 w-full rounded-xl border px-3 py-2 hidden';
              customInput.dataset.customFor = id;
              customInput.disabled = true;
              row.appendChild(customInput);
            }
            inputWrap.appendChild(row);
          });
        }
        else if (q.type === 'multiple') {
          q.choices.forEach(choice => {
            const id = `${q.id}-${choice.id}`;
            const row = document.createElement('div');
            row.className = 'space-y-2';
            const optionLabel = document.createElement('label');
            optionLabel.className = 'flex items-center gap-3 rounded-xl border px-3 py-2 hover:bg-gray-50';
            optionLabel.setAttribute('for', id);
            const cb = document.createElement('input');
            cb.type = 'checkbox';
            cb.name = q.id;
            cb.id = id;
            cb.value = choice.id;
            cb.className = 'size-4';
            const text = document.createElement('span');
            text.textContent = choice.label;
            optionLabel.appendChild(cb);
            optionLabel.appendChild(text);
            row.appendChild(optionLabel);
            if (choice.allowCustom) {
              const customInput = document.createElement('input');
              customInput.type = 'text';
              customInput.placeholder = choice.customPlaceholder || 'ËØ∑ËæìÂÖ•‰Ω†ÁöÑÁ≠îÊ°à';
              customInput.className = 'ml-7 mt-1 w-full rounded-xl border px-3 py-2 hidden';
              customInput.dataset.customFor = id;
              customInput.disabled = true;
              row.appendChild(customInput);
            }
            inputWrap.appendChild(row);
          });
        }
        const feedback = document.createElement('div');
        feedback.id = `fb-${q.id}`;
        feedback.className = 'text-sm mt-2 h-5';
        field.appendChild(inputWrap);
        field.appendChild(feedback);
        el.quizForm.appendChild(field);
        attempts.set(q.id, 0);
      });
      // progress init
      el.progress.textContent = `0 / ${QUESTIONS.length} correct`;
    }
    function handleChoiceChange(event) {
      const target = event.target;
      if (!target || target.tagName !== 'INPUT') return;
      const fieldset = target.closest('fieldset');
      if (!fieldset) return;
      if (target.type === 'radio') {
        const customInputs = fieldset.querySelectorAll('input[data-custom-for]');
        customInputs.forEach(input => {
          const match = input.dataset.customFor === target.id;
          input.classList.toggle('hidden', !match);
          input.disabled = !match;
          if (!match) input.value = '';
          if (match) input.focus();
        });
      } else if (target.type === 'checkbox') {
        const customInput = fieldset.querySelector(`input[data-custom-for="${target.id}"]`);
        if (customInput) {
          const show = target.checked;
          customInput.classList.toggle('hidden', !show);
          customInput.disabled = !show;
          if (!show) customInput.value = '';
          else customInput.focus();
        }
      }
    }
    // Collect and check answers
    async function checkAnswers() {
      let correctCount = 0;
      const attemptAnswers = {};
      for (const q of QUESTIONS) {
        const feedback = document.getElementById(`fb-${q.id}`);
        const hintEl = document.getElementById(`hint-${q.id}`);
        let ok = false;
        let failReason = null;
        if (q.type === 'text') {
          const input = el.quizForm.querySelector(`input[name="${q.id}"]`);
          const val = input.value;
          attemptAnswers[q.id] = { type: 'text', value: val };
          if (!val.trim()) failReason = 'empty';
          const h = await sha256Hex(val);
          ok = (h === q.answerHash);
        }
        else if (q.type === 'single') {
          const sel = el.quizForm.querySelector(`input[name="${q.id}"]:checked`);
          const selected = sel ? sel.value : '';
          const selectedChoice = selected ? q.choices.find(choice => choice.id === selected) || null : null;
          const customInput = sel ? el.quizForm.querySelector(`input[data-custom-for="${sel.id}"]`) : null;
          const customValue = customInput ? customInput.value.trim() : '';
          attemptAnswers[q.id] = {
            type: 'single',
            selectedOption: selected || null,
            selectedLabel: selectedChoice ? selectedChoice.label : null,
            customText: customValue || null
          };
          if (q.acceptAnySelection) {
            if (selectedChoice && selectedChoice.allowCustom) {
              ok = customValue.length > 0;
              if (!ok) failReason = 'custom-empty';
            } else if (selected) {
              ok = true;
            } else {
              failReason = 'no-selection';
            }
          } else if (selected && q.correctOptionsHash) {
            const h = await sha256Hex(selected);
            ok = (h === q.correctOptionsHash);
            if (!ok) failReason = 'mismatch';
          } else if (!selected) {
            failReason = 'no-selection';
          }
        }
        else if (q.type === 'multiple') {
          const selectedOptions = Array.from(el.quizForm.querySelectorAll(`input[name="${q.id}"]:checked`)).map(el => el.value).sort();
          const selected = selectedOptions.join('|');
          const customTexts = {};
          let customMissing = false;
          attemptAnswers[q.id] = {
            type: 'multiple',
            selectedOptions,
            selectedLabels: selectedOptions.map(val => {
              const match = q.choices.find(choice => choice.id === val);
              return match ? match.label : val;
            }),
            customTexts: null
          };
          selectedOptions.forEach(val => {
            const choice = q.choices.find(choice => choice.id === val);
            if (choice && choice.allowCustom) {
              const input = el.quizForm.querySelector(`input[data-custom-for="${q.id}-${choice.id}"]`);
              const text = input ? input.value.trim() : '';
              customTexts[val] = text;
              if (!text) {
                customMissing = true;
                failReason = 'custom-empty';
              }
            }
          });
          if (Object.keys(customTexts).length) {
            attemptAnswers[q.id].customTexts = customTexts;
          }
          if (!selectedOptions.length) failReason = failReason || 'no-selection';
          if (q.acceptAnySelection) {
            if (selectedOptions.length && !customMissing) {
              ok = true;
            } else {
              ok = false;
              if (!selectedOptions.length && !failReason) failReason = 'no-selection';
              if (customMissing) failReason = 'custom-empty';
            }
          } else if (Array.isArray(q.correctOptionsHashes) && q.correctOptionsHashes.length) {
            if (!selectedOptions.length) {
              ok = false;
            } else if (customMissing) {
              ok = false;
              failReason = 'custom-empty';
            } else {
              const h = await sha256Hex(selected);
              ok = q.correctOptionsHashes.includes(h);
              if (!ok) failReason = failReason || 'mismatch';
            }
          } else if (q.correctOptionsHash) {
            const h = await sha256Hex(selected);
            ok = (h === q.correctOptionsHash);
            if (!ok && !failReason) failReason = 'mismatch';
            if (ok && customMissing) {
              ok = false;
              failReason = 'custom-empty';
            }
          }
        }
        if (ok) {
          correctCount++;
          feedback.textContent = '‚úîÔ∏è Correct';
          feedback.className = 'text-sm mt-2 text-emerald-700';
        } else {
          const count = attempts.get(q.id) + 1;
          attempts.set(q.id, count);
          let failMessage = '‚ùå Try again';
          if (failReason === 'no-selection') failMessage = '‚ùå ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÈÄâÈ°π';
          else if (failReason === 'custom-empty') failMessage = '‚ùå ËØ∑Â°´ÂÜô‰Ω†ÁöÑÁêÜÁî±';
          else if (failReason === 'empty') failMessage = '‚ùå ËØ∑Â°´ÂÜôÁ≠îÊ°à';
          feedback.textContent = failMessage;
          feedback.className = 'text-sm mt-2 text-rose-700';
          if (count >= 2 && hintEl && hintEl.textContent) hintEl.classList.remove('hidden');
        }
      }
      el.progress.textContent = `${correctCount} / ${QUESTIONS.length} correct`;
      if (correctCount === QUESTIONS.length) await onPassed(attemptAnswers);
    }
    // After pass
    async function onPassed(answers) {
      // Cache pass with timestamp and token (if required)
      const payload = { passedAt: Date.now(), token: urlToken || null };
      writeCache(payload);
      let statusMessage = 'Access granted';
      let statusKind = 'success';
      if (answers) {
        const submission = {
          timestamp: new Date().toISOString(),
          token: urlToken || null,
          answers
        };
        try {
          const result = await uploadResponseToGithub(submission);
          if (result === 'saved') {
            statusMessage = 'Access granted. Response saved to GitHub.';
          } else if (result === 'skipped') {
            statusMessage = 'Access granted. Response not saved (GitHub upload disabled).';
            statusKind = 'warn';
          }
        } catch (error) {
          console.error('GitHub upload failed:', error);
          statusMessage = 'Access granted. Response could not be saved to GitHub.';
          statusKind = 'warn';
        }
      }
      showStatus(statusMessage, statusKind);
      revealContent();
    }
    function showStatus(msg, kind = 'info') {
      el.status.classList.remove('hidden');
      const kindClass = kind === 'success' ? 'status-success' : kind === 'warn' ? 'status-warn' : 'status-info';
      el.status.className = `mb-6 status-card ${kindClass}`;
      el.status.textContent = msg;
    }
    function revealContent() {
      // Render Markdown -> HTML and sanitize
      const rawHtml = marked.parse(MARKDOWN);
      const safeHtml = DOMPurify.sanitize(rawHtml);
      el.renderTarget.innerHTML = safeHtml;
      // Toggle cards
      el.quizCard.classList.add('hidden');
      el.contentCard.classList.remove('hidden');
      // Download buttons
      el.downloadMdBtn.onclick = (e) => {
        e.preventDefault();
        const blob = new Blob([MARKDOWN], { type: 'text/markdown;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'content.md';
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      };
      if (DOWNLOAD_URL_AFTER_PASS) {
        el.downloadUrlBtn.classList.remove('hidden');
        el.downloadUrlBtn.href = DOWNLOAD_URL_AFTER_PASS;
      }
      hideGiftEffect();
      if (el.giftBtn) {
        el.giftBtn.classList.remove('hidden');
      }
    }
    function hideGiftEffect() {
      if (!el.giftOverlay) return;
      el.giftOverlay.classList.remove('active');
      el.giftOverlay.classList.add('hidden');
      el.giftOverlay.innerHTML = '';
      if (giftDismissHandler) {
        document.removeEventListener('click', giftDismissHandler);
        giftDismissHandler = null;
      }
    }
    function showGiftEffect() {
      if (!el.giftOverlay) return;
      hideGiftEffect();
      el.giftOverlay.classList.remove('hidden');
      el.giftOverlay.classList.add('active');
      const roseTotal = 14;
      const petalTotal = 36;
      for (let i = 0; i < roseTotal; i++) {
        const rose = document.createElement('span');
        rose.className = 'rose';
        rose.style.left = `${Math.random() * 100}%`;
        rose.style.setProperty('--scale', (0.75 + Math.random() * 0.6).toFixed(2));
        rose.style.setProperty('--duration', `${8 + Math.random() * 4}s`);
        rose.style.setProperty('--delay', `${Math.random() * 2}s`);
        rose.style.setProperty('--drift', `${(Math.random() * 160 - 80).toFixed(0)}px`);
        el.giftOverlay.appendChild(rose);
      }
      for (let i = 0; i < petalTotal; i++) {
        const petal = document.createElement('span');
        petal.className = 'petal';
        petal.style.left = `${Math.random() * 100}%`;
        petal.style.setProperty('--scale', (0.6 + Math.random() * 0.6).toFixed(2));
        petal.style.setProperty('--duration', `${6 + Math.random() * 5}s`);
        petal.style.setProperty('--delay', `${Math.random() * 3}s`);
        petal.style.setProperty('--drift', `${(Math.random() * 200 - 100).toFixed(0)}px`);
        petal.style.setProperty('--rotate', `${(Math.random() * 120 - 60).toFixed(1)}deg`);
        el.giftOverlay.appendChild(petal);
      }
      giftDismissHandler = (evt) => {
        if (evt && evt.target === el.giftBtn) return;
        hideGiftEffect();
      };
      setTimeout(() => {
        document.addEventListener('click', giftDismissHandler, { once: true });
      }, 0);
    }
    function handleGiftBtnClick(event) {
      event.stopPropagation();
      if (!el.giftOverlay) return;
      const isActive = !el.giftOverlay.classList.contains('hidden');
      if (isActive) {
        hideGiftEffect();
      } else {
        showGiftEffect();
      }
    }
    async function uploadResponseToGithub(submission) {
      const {
        owner,
        repo,
        token,
        mode = 'file',
        path,
        branch,
        commitMessage,
        issueTitle,
        issueLabels
      } = GITHUB_UPLOAD_CONFIG;
      if (!owner || !repo || !token) {
        console.warn('GitHub upload skipped: missing owner, repo, or token.');
        return 'skipped';
      }
      const headers = {
        'Accept': 'application/vnd.github+json',
        'Authorization': `Bearer ${token}`,
        'X-GitHub-Api-Version': '2022-11-28'
      };
      const safeOwner = encodeURIComponent(owner);
      const safeRepo = encodeURIComponent(repo);
      if (mode === 'issue') {
        const titleBase = issueTitle || 'Quiz response';
        const timestamp = submission.timestamp || new Date().toISOString();
        const labelsPayload = Array.isArray(issueLabels) && issueLabels.length ? issueLabels : undefined;
        const bodyLines = [
          `**Timestamp:** ${timestamp}`,
          `**Token:** ${submission.token || '(none)'}`,
          '',
          '```json',
          JSON.stringify(submission.answers, null, 2),
          '```'
        ];
        const issueBody = bodyLines.join('\n');
        const issuePayload = {
          title: `${titleBase} (${timestamp})`,
          body: issueBody
        };
        if (labelsPayload) issuePayload.labels = labelsPayload;
        const issueRes = await fetch(`https://api.github.com/repos/${safeOwner}/${safeRepo}/issues`, {
          method: 'POST',
          headers: { ...headers, 'Content-Type': 'application/json' },
          body: JSON.stringify(issuePayload)
        });
        if (!issueRes.ok) {
          throw new Error(`GitHub issue creation failed with status ${issueRes.status}`);
        }
        return 'saved';
      }
      if (!path) {
        console.warn('GitHub upload skipped: no target path provided for file mode.');
        return 'skipped';
      }
      const targetBranch = branch || 'main';
      const encodedPath = path.split('/').map(segment => encodeURIComponent(segment)).join('/');
      const apiUrl = `https://api.github.com/repos/${safeOwner}/${safeRepo}/contents/${encodedPath}`;
      let existingSha;
      let entries = [];
      const readRes = await fetch(`${apiUrl}?ref=${encodeURIComponent(targetBranch)}`, { headers });
      if (readRes.status === 200) {
        const data = await readRes.json();
        existingSha = data.sha;
        const raw = data.content.replace(/\n/g, '');
        const bytes = Uint8Array.from(atob(raw), c => c.charCodeAt(0));
        const decoded = new TextDecoder().decode(bytes);
        const parsed = JSON.parse(decoded || '[]');
        if (Array.isArray(parsed)) entries = parsed;
        else if (parsed && typeof parsed === 'object') entries = [parsed];
      } else if (readRes.status !== 404) {
        throw new Error(`GitHub read failed with status ${readRes.status}`);
      }
      entries.push(submission);
      const jsonText = JSON.stringify(entries, null, 2);
      const encodedBytes = new TextEncoder().encode(jsonText);
      const base64Content = btoa(Array.from(encodedBytes, byte => String.fromCharCode(byte)).join(''));
      const body = {
        message: commitMessage || 'Add quiz response',
        content: base64Content,
        branch: targetBranch
      };
      if (existingSha) body.sha = existingSha;
      const saveRes = await fetch(apiUrl, {
        method: 'PUT',
        headers: { ...headers, 'Content-Type': 'application/json' },
        body: JSON.stringify(body)
      });
      if (!saveRes.ok) {
        throw new Error(`GitHub write failed with status ${saveRes.status}`);
      }
      return 'saved';
    }
    function resetAll() {
      clearCache();
      hideGiftEffect();
      el.quizCard.classList.remove('hidden');
      el.contentCard.classList.add('hidden');
      if (el.giftBtn) {
        el.giftBtn.classList.add('hidden');
      }
      renderQuiz();
      showStatus('Reset complete. Answers cleared on this device.', 'info');
    }
    // Try resume from cache
    function tryResume() {
      const cache = readCache();
      const hasPass = !!cache.passedAt;
      if (!hasPass) return false;
      if (REQUIRE_URL_TOKEN_TO_REUSE_PASS && cache.token !== (urlToken || null)) {
        showStatus('This link has a different token than the one used when you passed. Please answer again.', 'warn');
        return false;
      }
      showStatus('Pass recognized on this device.', 'success');
      revealContent();
      return true;
    }
    // Wire up
    el.quizForm.addEventListener('change', handleChoiceChange);
    el.checkBtn.addEventListener('click', checkAnswers);
    el.resetBtn.addEventListener('click', resetAll);
    if (el.giftBtn) el.giftBtn.addEventListener('click', handleGiftBtnClick);
    // Init
    (function init() {
      renderQuiz();
      tryResume();
    })();
  </script>
</body>
</html>
